{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useCharacter}from'../context/characterContext';import equipmentList from'../data/equipment.json';import StepWrapper from'../components/StepWrapper';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function EquipmentStep(_ref){let{formData={},onChange}=_ref;const{character,updateCharacter}=useCharacter();const{startingSilver=character.startingSilver||0,equipmentAlloc=character.equipmentAlloc||{}}=formData;// Local state mirrors formData\nconst[silver,setSilver]=useState(startingSilver);const[quantities,setQuantities]=useState(equipmentAlloc);// Sync silver changes to formData and context\nuseEffect(()=>{onChange('startingSilver',silver);updateCharacter({startingSilver:silver});},[silver]);// Sync equipment quantities to formData and context\nuseEffect(()=>{onChange('equipmentAlloc',quantities);updateCharacter({equipmentAlloc:quantities});},[quantities]);// If concept re-roll changes startingSilver, reset local\nuseEffect(()=>{setSilver(character.startingSilver||0);},[character.startingSilver]);const handleQtyChange=(name,val)=>{let v=parseInt(val,10);if(isNaN(v)||v<0)v=0;setQuantities(prev=>{const next={...prev,[name]:v};return next;});};// Compute totals\nconst totalSpent=Object.entries(quantities).reduce((sum,_ref2)=>{let[name,qty]=_ref2;const item=equipmentList.find(e=>e.name===name);return sum+((item===null||item===void 0?void 0:item.cost)||0)*qty;},0);const moneyLeft=silver-totalSpent;return/*#__PURE__*/_jsx(StepWrapper,{title:\"Equipment\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block font-medium\",children:\"Starting Silver Pieces\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:0,value:silver,onChange:e=>setSilver(+e.target.value||0),className:\"mt-1 w-32 border-gray-300 rounded\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"font-semibold mb-2\",children:\"Select Equipment\"}),/*#__PURE__*/_jsx(\"div\",{className:\"overflow-x-auto\",children:/*#__PURE__*/_jsxs(\"table\",{className:\"w-full table-auto\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{className:\"bg-gray-100\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"px-2 py-1 text-left\",children:\"Item\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-2 py-1 text-right\",children:\"Cost (SP)\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-2 py-1 text-center\",children:\"Quantity\"}),/*#__PURE__*/_jsx(\"th\",{className:\"px-2 py-1 text-right\",children:\"Total Cost\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:equipmentList.map(item=>{const qty=quantities[item.name]||0;const lineTotal=(item.cost||0)*qty;return/*#__PURE__*/_jsxs(\"tr\",{className:\"border-b\",children:[/*#__PURE__*/_jsx(\"td\",{className:\"px-2 py-1\",children:item.name}),/*#__PURE__*/_jsx(\"td\",{className:\"px-2 py-1 text-right\",children:item.cost}),/*#__PURE__*/_jsx(\"td\",{className:\"px-2 py-1 text-center\",children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",min:0,value:qty,onChange:e=>handleQtyChange(item.name,e.target.value),className:\"w-16 border-gray-300 rounded text-right\"})}),/*#__PURE__*/_jsx(\"td\",{className:\"px-2 py-1 text-right\",children:lineTotal})]},item.name);})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"pt-4 border-t\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Total Spent: \"}),totalSpent,\" SP\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:\"Silver Remaining: \"}),moneyLeft,\" SP\"]})]})]})});}","map":{"version":3,"names":["React","useState","useEffect","useCharacter","equipmentList","StepWrapper","jsx","_jsx","jsxs","_jsxs","EquipmentStep","_ref","formData","onChange","character","updateCharacter","startingSilver","equipmentAlloc","silver","setSilver","quantities","setQuantities","handleQtyChange","name","val","v","parseInt","isNaN","prev","next","totalSpent","Object","entries","reduce","sum","_ref2","qty","item","find","e","cost","moneyLeft","title","children","className","type","min","value","target","map","lineTotal"],"sources":["/workspaces/mythras-char-gen/src/steps/EquipmentStep.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useCharacter } from '../context/characterContext';\nimport equipmentList from '../data/equipment.json';\nimport StepWrapper from '../components/StepWrapper';\n\nexport default function EquipmentStep({ formData = {}, onChange }) {\n  const { character, updateCharacter } = useCharacter();\n  const {\n    startingSilver = character.startingSilver || 0,\n    equipmentAlloc = character.equipmentAlloc || {},\n  } = formData;\n\n  // Local state mirrors formData\n  const [silver, setSilver] = useState(startingSilver);\n  const [quantities, setQuantities] = useState(equipmentAlloc);\n\n  // Sync silver changes to formData and context\n  useEffect(() => {\n    onChange('startingSilver', silver);\n    updateCharacter({ startingSilver: silver });\n  }, [silver]);\n\n  // Sync equipment quantities to formData and context\n  useEffect(() => {\n    onChange('equipmentAlloc', quantities);\n    updateCharacter({ equipmentAlloc: quantities });\n  }, [quantities]);\n\n  // If concept re-roll changes startingSilver, reset local\n  useEffect(() => {\n    setSilver(character.startingSilver || 0);\n  }, [character.startingSilver]);\n\n  const handleQtyChange = (name, val) => {\n    let v = parseInt(val, 10);\n    if (isNaN(v) || v < 0) v = 0;\n    setQuantities(prev => {\n      const next = { ...prev, [name]: v };\n      return next;\n    });\n  };\n\n  // Compute totals\n  const totalSpent = Object.entries(quantities).reduce(\n    (sum, [name, qty]) => {\n      const item = equipmentList.find(e => e.name === name);\n      return sum + (item?.cost || 0) * qty;\n    },\n    0\n  );\n  const moneyLeft = silver - totalSpent;\n\n  return (\n    <StepWrapper title=\"Equipment\">\n      <div className=\"space-y-6\">\n        {/* Starting silver */}\n        <div>\n          <label className=\"block font-medium\">Starting Silver Pieces</label>\n          <input\n            type=\"number\"\n            min={0}\n            value={silver}\n            onChange={e => setSilver(+e.target.value || 0)}\n            className=\"mt-1 w-32 border-gray-300 rounded\"\n          />\n        </div>\n\n        {/* Equipment purchase table */}\n        <div>\n          <h3 className=\"font-semibold mb-2\">Select Equipment</h3>\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full table-auto\">\n              <thead>\n                <tr className=\"bg-gray-100\">\n                  <th className=\"px-2 py-1 text-left\">Item</th>\n                  <th className=\"px-2 py-1 text-right\">Cost (SP)</th>\n                  <th className=\"px-2 py-1 text-center\">Quantity</th>\n                  <th className=\"px-2 py-1 text-right\">Total Cost</th>\n                </tr>\n              </thead>\n              <tbody>\n                {equipmentList.map(item => {\n                  const qty = quantities[item.name] || 0;\n                  const lineTotal = (item.cost || 0) * qty;\n                  return (\n                    <tr key={item.name} className=\"border-b\">\n                      <td className=\"px-2 py-1\">{item.name}</td>\n                      <td className=\"px-2 py-1 text-right\">{item.cost}</td>\n                      <td className=\"px-2 py-1 text-center\">\n                        <input\n                          type=\"number\"\n                          min={0}\n                          value={qty}\n                          onChange={e => handleQtyChange(item.name, e.target.value)}\n                          className=\"w-16 border-gray-300 rounded text-right\"\n                        />\n                      </td>\n                      <td className=\"px-2 py-1 text-right\">{lineTotal}</td>\n                    </tr>\n                  );\n                })}\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        {/* Totals */}\n        <div className=\"pt-4 border-t\">\n          <div>\n            <span className=\"font-medium\">Total Spent: </span>\n            {totalSpent} SP\n          </div>\n          <div>\n            <span className=\"font-medium\">Silver Remaining: </span>\n            {moneyLeft} SP\n          </div>\n        </div>\n      </div>\n    </StepWrapper>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}